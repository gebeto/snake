!function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=12)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){var t=this;this.handlers={},document.addEventListener("keydown",function(e){65===e.keyCode?t.dispatchEvent("left",1):68===e.keyCode?t.dispatchEvent("right",1):87===e.keyCode?t.dispatchEvent("up",1):83===e.keyCode?t.dispatchEvent("down",1):81===e.keyCode?t.dispatchEvent("rotate",-1):69===e.keyCode&&t.dispatchEvent("rotate",1)})}return t.getInstance=function(){return this.instance||(this.instance=new t),this.instance},t.prototype.addEventListener=function(t,e){this.handlers[t]||(this.handlers[t]=[]),this.handlers[t].push(e)},t.prototype.dispatchEvent=function(t,e){console.log(t,e),this.handlers[t]&&this.handlers[t].forEach(function(t){return t(e)})},t}();e.Manipulator=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(2),i=function(){function t(t,e,r,i,o){this.color=t,this.x=e,this.y=r,this.matrix=new n.Matrix(i,o)}return t.prototype.draw=function(t){var e=this;this.matrix.grid.forEach(function(r,n){r.forEach(function(r,i){r&&t.fillRect(e.x+i,e.y+n,1,1)})})},t.prototype.set=function(t){var e=this;this.matrix.grid=t,t.forEach(function(t){t.forEach(function(t,r,n){n[r]&&(n[r]=e.color)})})},t}();e.AbstractShape=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){this.width=t,this.height=e,this.grid=[],this.fillGrid()}return t.prototype.fillGrid=function(){for(var t=0;t<this.height;t++){var e=new Array(this.width);e.fill(0),this.grid.push(e)}},t.prototype.coalesced=function(t,e,r){for(var n=0;n<t.grid.length;n++)for(var i=0;i<t.grid[n].length;i++)if(t.grid[n][i]&&this.grid[r+n][e+i])return!0;return!1},t.prototype.merge=function(t,e,r){for(var n=0;n<t.grid.length;n++)for(var i=0;i<t.grid[n].length;i++)t.grid[n][i]&&(this.grid[r+n][e+i]=t.grid[n][i])},t.prototype.rotate=function(t){for(var e,r=0;r<this.grid.length;r++)for(var n=0;n<r;n++)e=[this.grid[r][n],this.grid[n][r]],this.grid[n][r]=e[0],this.grid[r][n]=e[1];t>0?this.grid.forEach(function(t){return t.reverse()}):this.grid.reverse()},t}();e.Matrix=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WIDTH=12,e.HEIGHT=20,e.PIXEL_SIZE=20,e.BACKGROUND_COLOR="#000000",e.SHAPE_COLOR="#FF00FF"},function(t,e,r){"use strict";var n=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(3)),o=function(){function t(){this.layers=[],this.prevTime=0,this.dropCounter=0,this.dropInterval=1e3,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),document.body.appendChild(this.canvas),this.canvas.width=i.WIDTH*i.PIXEL_SIZE,this.canvas.height=i.HEIGHT*i.PIXEL_SIZE,this.canvas.style.backgroundColor=i.BACKGROUND_COLOR,this.canvas.style.height=i.HEIGHT*i.PIXEL_SIZE+"px",this.canvas.style.width=i.WIDTH*i.PIXEL_SIZE+"px",this.ctx.scale(i.PIXEL_SIZE,i.PIXEL_SIZE),this.ctx.fillStyle=i.SHAPE_COLOR,window.CTX=this.ctx}return t.getInstance=function(){return this.instance||(this.instance=new t),this.instance},t.prototype.loop=function(t){var e=this;void 0===t&&(t=0),this.ctx.clearRect(0,0,i.WIDTH,i.HEIGHT),this.layers.forEach(function(r){r.draw(e.ctx,t)}),requestAnimationFrame(this.loop.bind(this))},t.prototype.append=function(t){this.layers.push(t)},t}();e.Scene=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.prototype.draw=function(t){t.fillRect(0,0,100,100)},t}();e.GameMenu=n},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(e){var r=t.call(this,e,0,0,2,2)||this;return r.set([[1,1],[1,1]]),r}return i(e,t),e}(r(1).AbstractShape);e.OShape=o},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(e){var r=t.call(this,e,0,0,3,3)||this;return r.set([[1,1,1],[0,1,0],[0,0,0]]),r}return i(e,t),e}(r(1).AbstractShape);e.TShape=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(7),i=r(6),o=function(){function t(){}return t.prototype.createRandomShape=function(){var t=[this.createTShape,this.createOShape];return(0,t[Math.random()*t.length|0])()},t.prototype.createOShape=function(){return new i.OShape(1)},t.prototype.createTShape=function(){return new n.TShape(2)},t}();e.ShapeFactory=o},function(t,e,r){"use strict";var n=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(3)),o=r(2),a=[null,"red","pink","blue"],c=function(){function t(){this.matrix=new o.Matrix(i.WIDTH,i.HEIGHT),this.matrix.grid.push(new Array(i.WIDTH)),this.matrix.grid[this.matrix.grid.length-1].fill(1)}return t.prototype.draw=function(t){this.matrix.grid.forEach(function(e,r){e.forEach(function(e,n){e&&(t.fillStyle=a[e],t.fillRect(n,r,1,1))})})},t.prototype.coalesced=function(t){return this.matrix.coalesced(t.matrix,t.x,t.y+1)},t.prototype.merge=function(t){this.matrix.merge(t.matrix,t.x,t.y)},t}();e.Area=c},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(9),i=r(8),o=r(0),a=new i.ShapeFactory,c=function(){function t(){var t=this;this.prevTime=0,this.dropCounter=0,this.dropInterval=1e3,this.manipulator=o.Manipulator.getInstance(),this.area=new n.Area,this.currentShape=a.createTShape(),this.nextShape=a.createRandomShape(),this.manipulator.addEventListener("left",function(e){t.area.matrix.coalesced(t.currentShape.matrix,t.currentShape.x-1,t.currentShape.y)||(t.currentShape.x-=1)}),this.manipulator.addEventListener("right",function(e){t.area.matrix.coalesced(t.currentShape.matrix,t.currentShape.x+1,t.currentShape.y)||(t.currentShape.x+=1)}),this.manipulator.addEventListener("down",function(e){t.isColision(function(){return t.merge()}),t.currentShape.y+=1,t.dropCounter=0}),this.manipulator.addEventListener("rotate",function(e){t.currentShape.matrix.rotate(e),t.area.matrix.coalesced(t.currentShape.matrix,t.currentShape.x,t.currentShape.y)&&t.currentShape.matrix.rotate(-e)})}return t.prototype.isColision=function(t,e){var r=this.area.coalesced(this.currentShape),n=r?t:e;return n&&n(),r},t.prototype.merge=function(){this.area.merge(this.currentShape),this.currentShape=this.nextShape,this.nextShape=a.createRandomShape()},t.prototype.draw=function(t,e){var r=this,n=e-this.prevTime;this.prevTime=e,this.dropCounter+=n,this.dropCounter>this.dropInterval&&this.isColision(function(){r.merge()},function(){r.currentShape.y++,r.dropCounter=0}),this.area.draw(t),this.currentShape.draw(t)},t}();e.GamePlay=c},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(10);e.GamePlay=n.GamePlay;var i=r(5);e.GameMenu=i.GameMenu},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(11),i=r(4),o=r(0);document.addEventListener("DOMContentLoaded",function(){var t=i.Scene.getInstance(),e=(o.Manipulator.getInstance(),new n.GamePlay);t.append(e),t.loop()})}]);